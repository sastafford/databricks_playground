# This is a Databricks asset bundle definition for the Movies Lakehouse.
# See https://docs.databricks.com/dev-tools/bundles/index.html for documentation.
bundle:
  name: movies

variables:
  catalog:
    default: usa

resources:
  schemas: 
    movies_schema:
      catalog_name: ${var.catalog}
      name: ${workspace.current_user.short_name}_movies
  volumes:
    movies_volume:
      catalog_name: ${var.catalog}
      name: temp
      schema_name: ${resources.schemas.movies_schema.name}
  pipelines:
    movies_pipeline:
      name: movies_pipeline
    libraries:
      - glob:
          include:./movies_pipeline/transformations/bronze_imdb_movies.sql
      - glob:
          include: ./movies_pipeline/transformations/bronze_mongodb_movies.sql
      - glob:
          include: ./movies_pipeline/transformations/silver_movies.sql
      - glob:
          include: ./movies_pipeline/transformations/gold_genre_analysis.sql
    schema: movies
    continuous: false
    development: true
    photon: true
    channel: CURRENT
    catalog: usa
    serverless: true
    root_path: ./movies_pipeline

targets:
  movies_target:
    default: true

workspace:
  profile: DEFAULT